(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{252:function(e){e.exports=[{constant:!1,inputs:[{name:"message_text",type:"string"},{name:"recipient",type:"address"}],name:"create_message",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"username",type:"bytes32"}],name:"create_txtr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"},{name:"addr",type:"address"}],name:"get_one_message",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"},{name:"addr",type:"address"}],name:"get_one_message_recipient",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"},{name:"addr",type:"address"}],name:"get_one_message_sender",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"},{name:"addr",type:"address"}],name:"get_one_sent_message",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"}],name:"get_public_message_address",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"get_public_message_count",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"}],name:"get_public_message_message",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"index",type:"uint256"}],name:"get_public_message_sender",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"addr",type:"address"},{name:"index",type:"uint256"}],name:"get_received_message",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"addr",type:"address"}],name:"get_received_messages_total",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"addr",type:"address"},{name:"index",type:"uint256"}],name:"get_sent_message",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"addr",type:"address"}],name:"get_sent_messages_total",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"addr",type:"address"}],name:"get_sent_user_message_total",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"pm",type:"address"},{name:"_encrypted_message",type:"string"}],name:"pm_alice_send_encrypted_message",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"pm",type:"address"},{name:"_error",type:"bool"}],name:"pm_bob_final",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"pm",type:"address"},{name:"bob_public",type:"string"}],name:"pm_bob_reply",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"bob",type:"address"}],name:"pm_init",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"message_text",type:"string"}],name:"send_public_message",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,name:"message_addr",type:"address"},{indexed:!1,name:"message",type:"string"},{indexed:!0,name:"_from",type:"address"}],name:"NewPublicMessage",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"}],name:"NewTxtr",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"}],name:"NewPrivateMessage",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_public",type:"string"}],name:"NewBobReply2",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_public",type:"string"},{indexed:!1,name:"encrypted_message",type:"string"}],name:"NewAliceSendEncryptedMessage",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_error",type:"bool"}],name:"NewBobFinal",type:"event"},{constant:!0,inputs:[{name:"",type:"address"}],name:"txtrs",outputs:[{name:"name",type:"bytes32"},{name:"owner",type:"address"},{name:"exists",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}]},253:function(e){e.exports=[{constant:!1,inputs:[{name:"_encrypted_message",type:"string"}],name:"alice_send_encrypted_message",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_bob_public",type:"string"}],name:"bob_reply",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"encrypted_message",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"bob_finalized",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"bob_error",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_error",type:"bool"}],name:"bob_final",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"bob_public",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"stage",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"bob",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"alice",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"_alice",type:"address"},{name:"_bob",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"}],name:"NewPrivateMessage",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_public",type:"string"}],name:"NewBobReply",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_public",type:"string"},{indexed:!1,name:"encrypted_message",type:"string"}],name:"NewAliceSendEncryptedMessage",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"PrivateMessage",type:"address"},{indexed:!1,name:"alice",type:"address"},{indexed:!1,name:"bob",type:"address"},{indexed:!1,name:"bob_error",type:"bool"}],name:"NewBobFinal",type:"event"}]},254:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return w});var a=n(2),s=n.n(a),r=n(13),c=n(3),i=n(5),u=n(10),o=n(7),l=n(11),p=n(0),m=n.n(p),d=n(16),b=n.n(d),y=n(40),f=n.n(y),g=n(4),h=n(255),v=n(256);window.db={},window.rec_state={};var x=n(49).ec,w=function(t){function n(e){var t;return Object(c.a)(this,n),(t=Object(u.a)(this,Object(o.a)(n).call(this,e))).state={receivedMessages:[],errormessage:"",keys:{},message:void 0},t}return Object(l.a)(n,t),Object(i.a)(n,[{key:"fetch",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPrivateMessages();case 2:t=e.sent,this.setState({receivedMessages:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setUpListeners();case 2:return e.next=4,this.fetch();case 4:window.rec_state=this.state;case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setUpListeners",value:function(){var e=Object(r.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this,g.b.events.allEvents("allEvents",{fromBlock:"latest"},function(){var e=Object(r.a)(s.a.mark(function e(n,a){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("event",a),e.next=3,t.fetch();case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPrivateMessages",value:function(){var t=Object(r.a)(s.a.mark(function t(){var n,a,r,c,i,u,o,l,p,m,d,b,y,h,v,w,_;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.b.methods.get_received_messages_total(g.h).call();case 2:n=t.sent,a=[],r=n-1;case 5:if(!(r>=0)){t.next=33;break}return t.next=8,g.b.methods.get_received_message(g.h,r).call();case 8:return c=t.sent,i=Object(g.e)(c),t.next=12,i.methods.stage().call();case 12:return u=t.sent,o="",t.next=16,i.methods.alice().call();case 16:return l=t.sent,t.next=19,i.methods.bob().call();case 19:return p=t.sent,t.next=22,i.methods.bob_public().call();case 22:return m=t.sent,t.next=25,i.methods.encrypted_message().call();case 25:if(d=t.sent,"3"==u&&(b=new x("secp256k1"),y=e.from(m,"hex").toString("hex"),console.log("should be same kesy bob",m,y),h=window.localStorage[y])){v=e.from(y.slice(2),"hex"),f.a.encrypt(v,"test"),w=b.keyFromPrivate(h);try{o=f.a.decrypt(w,e.from(d,"hex")).toString()}catch(s){console.log(s)}console.log("plaintext2",o)}_={plaintext:o,stage:u,alice:l,bob:p,id:r,address:c,encrypted_message:d,bob_public:m},a.push(_);case 30:r--,t.next=5;break;case 33:return t.abrupt("return",a);case 34:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return m.a.createElement("div",null,this.state.receivedMessages.map(function(e){return m.a.createElement(b.a,{bsStyle:"info",key:e.id,className:"centeralign"},m.a.createElement(b.a.Heading,null,m.a.createElement(b.a.Title,{componentClass:"h3"},function(){switch(e.stage){case"1":return"Incoming Conversation request";case"2":return"Waiting on recieving encrypted message ";case"3":return"Encrypted Message received";case"4":return"Encrypted Message received and status = Read";default:return"unknown stage "}}())),m.a.createElement(b.a.Body,{style:{backgroundColor:g.a.hex(e.alice),color:Object(g.c)(g.a.hex(e.alice))}},m.a.createElement("p",null,function(){switch(e.stage){case"1":return"incoming message request from "+e.alice;case"2":return"Waiting on an encrypted message from "+e.alice;case"3":return"Secure message from "+e.alice;default:return e.alice}}()),m.a.createElement(h.a,{account:e.address,stage:e.stage}),m.a.createElement(v.a,{message:e})))}))}}]),n}(m.a.Component)}).call(this,n(9).Buffer)},255:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n(3),s=n(5),r=n(10),c=n(7),i=n(11),u=n(0),o=n.n(u),l=n(4),p=(n(32),n(40),function(e){function t(e){return Object(a.a)(this,t),Object(r.a)(this,Object(c.a)(t).call(this,e))}return Object(i.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){Object(l.g)(e.account)}},{key:"render",value:function(){var e=this;return 1==this.props.stage?o.a.createElement("div",null,o.a.createElement("p",null,this.props.account),o.a.createElement("input",{type:"button",style:{color:"black"},value:"Accept Conversation",onClick:function(t){return e.handleClick(e.props)}})):o.a.createElement(o.a.Fragment,null)}}]),t}(o.a.Component))},256:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(3),s=n(5),r=n(10),c=n(7),i=n(11),u=n(0),o=n.n(u),l=(n(4),n(32),n(40),function(e){function t(e){return Object(a.a)(this,t),Object(r.a)(this,Object(c.a)(t).call(this,e))}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return 3==this.props.message.stage?o.a.createElement("div",null,o.a.createElement("p",null,this.props.message.plaintext)):o.a.createElement(o.a.Fragment,null)}}]),t}(o.a.Component))},257:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return h});n(67);var a=n(2),s=n.n(a),r=n(13),c=n(3),i=n(5),u=n(10),o=n(7),l=n(66),p=n(11),m=n(0),d=n.n(m),b=n(16),y=n.n(b),f=n(4),g=(n(32),n(40)),h=function(t){function n(t){var a;return Object(c.a)(this,n),(a=Object(u.a)(this,Object(o.a)(n).call(this,t))).onSendSecretMessage=function(){var t=Object(r.a)(s.a.mark(function t(n){var r,c,i,u,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=Object(f.e)(a.state.message.address),c=a.state.message.bob_public,i=e.from(c.slice(2),"hex"),t.next=6,f.i.eth.getAccounts();case 6:return u=t.sent,o=g.encrypt(i,a.state.secret_message),t.next=10,r.methods.alice_send_encrypted_message(o.toString("hex")).send({gasPrice:0,from:u[0]});case 10:return t.sent,t.abrupt("return",!1);case 12:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),a.myChangeHandler=function(e){a.setState({secret_message:e.target.value})},console.log("PROPS",t),a.state={message:t.message,errormessage:t.message},a.onSendSecretMessage=a.onSendSecretMessage.bind(Object(l.a)(a)),a}return Object(p.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.message;return d.a.createElement(y.a,{bsStyle:"info",key:e.id,className:"centeralign"},d.a.createElement(y.a.Heading,null,d.a.createElement(y.a.Title,{componentClass:"h3"},function(){switch(e.stage){case"1":return"Key request sent.";case"2":return"Recipient has shared one time use encryption keys with you. Time to encrypt and send the message!";case"3":return"Conversation #"+e.id;case"4":return"Encrypted Message received by "+e.bob;default:return"unknown stage "}}())),d.a.createElement(y.a.Body,{style:{backgroundColor:f.a.hex(e.bob),color:Object(f.c)(f.a.hex(e.bob))}},d.a.createElement("div",null,d.a.createElement("p",null,"conversation wtih"),d.a.createElement("p",null,e.bob),d.a.createElement("p",null,e.id," total messages"))))}}]),n}(d.a.Component)}).call(this,n(9).Buffer)},264:function(e,t,n){e.exports=n(625)},269:function(e,t,n){},271:function(e,t,n){e.exports=n.p+"static/media/logo.ee7cd8ed.svg"},272:function(e,t,n){},395:function(e,t){},4:function(e,t,n){"use strict";(function(e){n.d(t,"i",function(){return m}),n.d(t,"h",function(){return a}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return f}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return x}),n.d(t,"a",function(){return w}),n.d(t,"j",function(){return _});var a,s=n(2),r=n.n(s),c=n(13),i=n(151),u=n.n(i),o=n(252),l=n(253),p=n(49).ec,m=(new p("secp256k1"),new u.a(window.ethereum));window.w3=m;var d=new m.eth.Contract(o,"0xB43Fd3ba31365E15A35f428C6E2D62bE07275eCC");function b(){return d}function y(e){return new(new u.a(window.ethereum).eth.Contract)(l,e)}function f(){return g.apply(this,arguments)}function g(){return(g=Object(c.a)(r.a.mark(function e(){var t,n,s,c,i,u,o,l,p,b;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.eth.getAccounts();case 2:return e.sent,e.next=5,d.methods.get_sent_messages_total(a).call();case 5:t=e.sent,n=[],s=t-1;case 8:if(!(s>=0)){e.next=35;break}return e.next=11,d.methods.get_sent_message(a,s).call();case 11:return c=e.sent,i=y(c),e.next=15,i.methods.alice().call();case 15:return u=e.sent,e.next=18,i.methods.bob().call();case 18:return o=e.sent,e.next=21,i.methods.stage().call();case 21:if(l=e.sent,p={stage:l,alice:u,bob:o,id:s},"2"!=l){e.next=29;break}return e.next=27,i.methods.bob_public().call();case 27:b=e.sent,p.bob_public=b;case 29:p.address=c,p.id=s,n.push(p);case 32:s--,e.next=8;break;case 35:return console.log("Messages",n),e.abrupt("return",n);case 37:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return(v=Object(c.a)(r.a.mark(function t(n){var a,s,c,i,u,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.utils.randomHex(32),s=new p("secp256k1"),c=s.keyFromPrivate(a),i=c.getPublic(),e.from(i.encode()),u=e.from(i.encode()).toString("hex"),window.db[u]=a,window.localStorage.setItem(u,a),t.next=10,m.eth.getAccounts();case 10:return o=t.sent,t.next=13,window.ethereum.enable();case 13:return t.next=15,d.methods.pm_bob_reply(n,u).send({gasPrice:0,from:o[0]});case 15:t.sent;case 16:case"end":return t.stop()}},t)}))).apply(this,arguments)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;if(void 0===e)return"#000";var n,a=function(e){if(e&&void 0!==e&&""!==e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:void 0}}(e);return void 0===a?"#000":(299*(n=a).r+587*n.g+114*n.b)/1e3>=t?"#000":"#fff"}var w=new(n(622));function _(){return k.apply(this,arguments)}function k(){return(k=Object(c.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.ethereum){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,window.ethereum.enable();case 4:return e.next=6,m.eth.getAccounts();case 6:return t=e.sent,d.options.from=t[0],a=t[0],e.abrupt("return",!0);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}}).call(this,n(9).Buffer)},402:function(e,t){},419:function(e,t){},421:function(e,t){},436:function(e,t){},526:function(e,t){},625:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(32),c=n.n(r),i=(n(269),n(3)),u=n(5),o=n(10),l=n(7),p=n(11),m=(n(271),n(272),n(2)),d=n.n(m),b=n(13),y=n(16),f=n.n(y),g=n(250),h=n.n(g),v=(a.Component,n(67)),x=n(4),w=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(o.a)(this,Object(l.a)(t).call(this,e))).mySubmitHandler=function(){var e=Object(b.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,x.i.eth.getAccounts();case 3:return e.sent,e.next=6,x.b.methods.send_public_message(n.state.message).send();case 6:return e.sent,e.abrupt("return",!1);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.myChangeHandler=function(e){var t=e.target.name,a=e.target.value,r="";"message"===t&&""==a&&(r=s.a.createElement("strong",null,"Your message can't be blank")),n.setState({errormessage:r}),n.setState(Object(v.a)({},t,a))},n.state={message:"",errormessage:"",account:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.i.eth.getAccounts();case 2:t=e.sent,this.setState({account:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement(f.a,{bsStyle:"info",className:"centeralign"},s.a.createElement(f.a.Heading,null,s.a.createElement(f.a.Title,{componentClass:"h3"},"Send Public Message")),s.a.createElement(f.a.Body,{style:{backgroundColor:x.a.hex(this.state.account)}},s.a.createElement("form",{onSubmit:this.mySubmitHandler},s.a.createElement("input",{type:"text",name:"message",onChange:this.myChangeHandler}),s.a.createElement("input",{type:"submit",value:"Share"}),this.state.errormessage)))}}]),t}(s.a.Component),_=(n(40),n(40),function(e){function t(e){return Object(i.a)(this,t),Object(o.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleClick",value:function(){var e=Object(b.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.i.eth.getAccounts();case 2:return n=e.sent,e.next=5,x.b.methods.pm_init(this.props.address).send({gasPrice:0,from:n[0]});case 5:return e.sent,e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("p",null,this.props.account),s.a.createElement("input",{type:"button",value:"Start a secret conversation",onClick:function(t){return e.handleClick(e.props)}}))}}]),t}(s.a.Component)),k=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={publicMessages:{data:[]},account:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setUpListeners",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this,x.b.events.allEvents("allEvents",{fromBlock:"latest"},function(){var e=Object(b.a)(d.a.mark(function e(n,a){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("event",a),e.next=3,t.fetch();case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetch",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.i.eth.getAccounts();case 2:return t=e.sent,e.next=5,this.getPublicMessages();case 5:n=e.sent,this.setState({publicMessages:{data:n},account:t});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch();case 2:return e.next=4,this.setUpListeners();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPublicMessages",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,n,a,s,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.b.methods.get_public_message_count().call();case 2:t=e.sent,n=[],a=t-1;case 5:if(!(a>=0)){e.next=16;break}return e.next=8,x.b.methods.get_public_message_message(a).call();case 8:return s=e.sent,e.next=11,x.b.methods.get_public_message_sender(a).call();case 11:r=e.sent,n.push({message:s,sender:r,id:a});case 13:a--,e.next=5;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",null,this.state.publicMessages.data.map(function(e,t){return s.a.createElement(f.a,{bsStyle:"info",key:e.id,className:"centeralign"},s.a.createElement(f.a.Heading,null,s.a.createElement(f.a.Title,{componentClass:"h3"},e.sender)),s.a.createElement(f.a.Body,{style:{backgroundColor:x.a.hex(e.sender)}},s.a.createElement("p",{style:{color:Object(x.c)(x.a.hex(e.sender))}},e.message),s.a.createElement("div",null," ",s.a.createElement(_,{address:e.sender}))))}))}}]),t}(s.a.Component),E=n(65),O=(s.a.Component,function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,"Active Conversations"))}}]),t}(s.a.Component)),j=n(254),M=n(257),C=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(o.a)(this,Object(l.a)(t).call(this,e))).mySubmitHandler=function(){var e=Object(b.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,x.i.eth.getAccounts();case 3:return a=e.sent,e.next=6,x.b.methods.pm_init(n.state.address).send({gasPrice:0,from:a[0]});case 6:return e.sent,e.abrupt("return",!1);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.myChangeHandler=function(e){var t=e.target.name,a=e.target.value,r="";"message"===t&&""==a&&(r=s.a.createElement("strong",null,"Your message can't be blank")),n.setState({errormessage:r}),n.setState(Object(v.a)({},t,a))},n.state={message:"",sentMessages:[],errormessage:"",account:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setUpListeners",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this,x.b.events.allEvents("allEvents",{fromBlock:"latest"},function(){var e=Object(b.a)(d.a.mark(function e(n,a){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("LOGGING THAT EVENT PICKED UP NEWS"),e.next=3,t.getSentMessages();case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("start send private msg"),e.next=3,this.setUpListeners();case 3:return e.next=5,this.getSentMessages();case 5:e.sent;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSentMessages",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,n,a,s,r,c,i,u,o,l,p,m;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.i.eth.getAccounts();case 2:return t=e.sent,this.state.account=t,e.next=6,x.b.methods.get_sent_messages_total(x.h).call();case 6:n=e.sent,a=this.state.sentMessages,s={account:!0},r={account:!0},c=n-1;case 11:if(!(c>=0)){e.next=39;break}return e.next=14,x.b.methods.get_sent_message(x.h,c).call();case 14:return i=e.sent,u=Object(x.e)(i),e.next=18,u.methods.stage().call();case 18:return o=e.sent,e.next=21,u.methods.alice().call();case 21:return l=e.sent,e.next=24,u.methods.bob().call();case 24:if(p=e.sent,m={stage:o,alice:l,bob:p,id:c},"2"!=o){e.next=28;break}return e.abrupt("continue",36);case 28:if(m.address="address",m.id=c,!s[m.alice]||!r[m.bob]){e.next=33;break}return e.abrupt("continue",36);case 33:a.push(m),s[m.alice]=!0,r[m.bob]=!0;case 36:c--,e.next=11;break;case 39:return this.setState({sentMessages:a}),e.abrupt("return",a);case 41:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",null,this.state.sentMessages.map(function(e){return s.a.createElement(M.a,{message:e,key:e.id})}))}}]),t}(s.a.Component),S=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).myChangeHandler=function(e){n.setState({address:e.target.value})},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"mySubmitHandler",value:function(){var e=Object(b.a)(d.a.mark(function e(t,n){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,x.i.eth.getAccounts();case 3:return a=e.sent,e.next=6,x.b.methods.pm_init(t.address).send({gasPrice:0,from:a[0]});case 6:return e.sent,e.abrupt("return",!1);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(f.a,{bsStyle:"info",className:"centeralign"},s.a.createElement(f.a.Heading,null,s.a.createElement(f.a.Title,{componentClass:"h3"},"Start a new Conversation")),s.a.createElement(f.a.Body,null,s.a.createElement("form",{onSubmit:function(t){return e.mySubmitHandler(e.state,t)}},s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"address"},"Ethereum Address"),s.a.createElement("input",{type:"text",name:"address",placeholder:"0xSatoshi",onChange:this.myChangeHandler})),s.a.createElement("div",null,s.a.createElement("input",{type:"submit",value:"Start"}))))),s.a.createElement(C,null)))}}]),t}(s.a.Component),N=n(260),P=function(e){var t=Object(a.useState)([]),n=Object(N.a)(t,2),r=n[0],c=n[1];function i(){return u.apply(this,arguments)}function u(){return(u=Object(b.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.f)();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(a.useEffect)(function(){x.b.events.allEvents("allEvents",{fromBlock:"latest"},function(){var e=Object(b.a)(d.a.mark(function e(t,n){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(""),e.next=3,i();case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),i().then(function(){})},[]),s.a.createElement("div",null,r.map(function(e){return s.a.createElement(E.a,{message:e,key:e.id})}),s.a.createElement("input",{type:"submit",onClick:x.f}),s.a.createElement("input",{type:"submit",value:"fetch",onClick:i}))},A=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(o.a)(this,Object(l.a)(t).call(this,e))).state={networkname:"private"},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.j)();case 2:if(!e.sent){e.next=15;break}return e.next=6,window.w3.eth.net.getNetworkType();case 6:return t=e.sent,this.setState({networkname:t}),e.next=10,this.getPublicMessages();case 10:n=e.sent,console.log("response is ",n),this.setState({publicMessages:{data:n}}),e.next=16;break;case 15:this.setState({networkname:"no-web3"});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPublicMessages",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,n,a,s,r,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("private"==this.state.networkname){e.next=2;break}return e.abrupt("return",{});case 2:return e.next=4,x.b.methods.get_public_message_count().call();case 4:t=e.sent,console.log("messages count",t),n=[],a=0,s=t-1;case 9:if(!(s>=0)){e.next=24;break}if(5!=(a+=1)){e.next=13;break}return e.abrupt("break",24);case 13:return console.log("index is",s),e.next=16,x.b.methods.get_public_message_message(s).call();case 16:return r=e.sent,e.next=19,x.b.methods.get_public_message_sender(s).call();case 19:c=e.sent,n.push({message:r,sender:c,id:s});case 21:s--,e.next=9;break;case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return"no-web3"==this.state.networkname?s.a.createElement("div",null,s.a.createElement("h1",null,s.a.createElement("a",{href:"https://metamask.io",target:"_blank"},"Install MetaMask to use the site"),s.a.createElement("a",{className:"cover",href:"https://metamask.io",target:"_blank"},s.a.createElement("img",{src:"/assets/images/download-extension.png"})))):"private"!=this.state.networkname?s.a.createElement("div",null,s.a.createElement("h1",null,"Metamask is on the wrong network "),s.a.createElement("h1",null,"Switch to MaticV3"),s.a.createElement("h2",null,"Add new RPC URL:"),s.a.createElement("h4",{className:"App-subtitle"},"  ",s.a.createElement("br",null),"https://testnetv3.matic.network/ "),s.a.createElement("img",{className:"metamask",src:"/assets/images/metamask_change.png"}),s.a.createElement("img",{className:"metamask",src:"/assets/images/metamask_example.png"}),s.a.createElement("img",{className:"metamask",src:"/assets/images/metamask_settings.png"})):this.state.publicMessages?s.a.createElement("div",{className:"addmargin"},s.a.createElement("div",{className:"col-md-3"},s.a.createElement("div",null,s.a.createElement(w,null),s.a.createElement(k,null))),s.a.createElement("div",{className:"col-md-3"},s.a.createElement("div",null,s.a.createElement("h2",null,"Encrypted Conversations"),s.a.createElement(S,null))),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("div",{className:"row"},s.a.createElement(O,null)),s.a.createElement("div",{className:"col-md-12"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("p",null,"Outgoing Secure Messages"),s.a.createElement(P,null)),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("p",null,"Incoming Secure Messages"),s.a.createElement(j.a,null))))):s.a.createElement("p",null,"Loading data")}}]),t}(a.Component),B=n(631),H=n(632),L=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement(B.a,{basename:""},s.a.createElement("div",{className:"App"},s.a.createElement("h1",{className:"App-title"},"Txt.rs.2.3.6"),s.a.createElement("a",{href:"https://github.com/snissn/txtrs-react",target:"_blank",className:"github-corner","aria-label":"View source on GitHub"},s.a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 250 250",className:"github1","aria-hidden":"true"},s.a.createElement("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),s.a.createElement("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",className:"octo-arm github2"}),s.a.createElement("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"octo-body"}))),s.a.createElement(H.a,{exact:!0,path:"/",component:A})))}}]),t}(a.Component),T=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(s.a.createElement(L,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");T?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):D(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):D(e)})}}()},65:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return h});var a=n(2),s=n.n(a),r=n(13),c=n(3),i=n(5),u=n(10),o=n(7),l=n(66),p=n(11),m=n(0),d=n.n(m),b=n(16),y=n.n(b),f=n(4),g=(n(32),n(40)),h=function(t){function n(t){var a;return Object(c.a)(this,n),(a=Object(u.a)(this,Object(o.a)(n).call(this,t))).onSendSecretMessage=function(){var t=Object(r.a)(s.a.mark(function t(n){var r,c,i,u,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),Object(f.e)(a.props.message.address),r=a.props.message.bob_public,c=e.from(r.slice(2),"hex"),t.next=6,f.i.eth.getAccounts();case 6:return i=t.sent,u=g.encrypt(c,a.state.secret_message),o=Object(f.d)(),t.next=11,o.methods.pm_alice_send_encrypted_message(a.props.message.address,u.toString("hex")).send({gasPrice:0,from:i[0]});case 11:return t.sent,t.abrupt("return",!1);case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),a.myChangeHandler=function(e){a.setState({secret_message:e.target.value})},console.log("PROPS",t),a.state={secret_message:""},a.onSendSecretMessage=a.onSendSecretMessage.bind(Object(l.a)(a)),a}return Object(p.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(r.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.message;return console.log("MESSAGE",e),d.a.createElement(y.a,{bsStyle:"info",key:e.id,className:"centeralign"},d.a.createElement(y.a.Heading,null,d.a.createElement(y.a.Title,{componentClass:"h3"},function(){switch(e.stage){case"1":return"Key request sent.";case"2":return"Encrypted Channel";case"3":return"Encrypted Message sent to "+e.bob;case"4":return"Encrypted Message received by "+e.bob;default:return"unknown stage "}}())),d.a.createElement(y.a.Body,{style:{backgroundColor:f.a.hex(e.bob),color:Object(f.c)(f.a.hex(e.bob))}},this.renderForm(e)))}},{key:"renderForm",value:function(e){return"2"==e.stage?d.a.createElement("form",{onSubmit:this.onSendSecretMessage,className:"form"},d.a.createElement("label",{htmlFor:"Receiver"},"Receiver"),d.a.createElement("div",{name:"Receiver"},e.bob),d.a.createElement("label",{htmlFor:"message"},"Secret Message"),d.a.createElement("input",{type:"text",name:"message",placeholder:"Secret Message",value:this.state.secret_message,onChange:this.myChangeHandler}),d.a.createElement("input",{type:"submit",value:"Send"})):"1"==e.stage?d.a.createElement("span",null,"Conversation with ",e.bob," requsted "):d.a.createElement("span",null,"Message Sent")}}]),n}(d.a.Component)}).call(this,n(9).Buffer)}},[[264,2,1]]]);
//# sourceMappingURL=main.f08009be.chunk.js.map